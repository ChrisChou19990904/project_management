<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>å¤–èªå­¸ç¿’å¯¦é«”æ›¸è²©è³£ç¶²ç«™ï¼šå°ˆæ¡ˆæ ¸å¿ƒèªªæ˜</title>
  <style>
    body { font-family: 'Helvetica Neue', Arial, sans-serif; line-height: 1.6; margin: 20px; color: #333; }
    h1 { color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 5px; }
    h2 { color: #333; margin-top: 30px; border-left: 5px solid #ffc107; padding-left: 10px; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; }
    th { background-color: #f2f2f2; color: #333; }
    .highlight { font-weight: bold; color: #d9534f; }
    .citation { font-size: 0.9em; color: #888; margin-top: 5px;}
    a{text-decoration:none;}
    a:hover {text-decoration:underline;}
    a:visited { color: blue; }
  </style>
</head>
<body>

<h1>å¤–èªå­¸ç¿’å¯¦é«”æ›¸è²©è³£ç¶²ç«™ï¼šå°ˆæ¡ˆæ ¸å¿ƒèªªæ˜</h1>
<p>
  <strong>å°ˆæ¡ˆåç¨±ï¼š</strong>å¤–èªå­¸ç¿’å¯¦é«”æ›¸è²©è³£ç¶²ç«™<br>
  <strong>é–‹ç™¼è€…ï¼š</strong>å‘¨å½¥å»· D1397102<br>
  <strong>æ ¸å¿ƒæŠ€è¡“æ£§ï¼š</strong>Vue 3 + Spring Boot + Supabase
</p>

<hr>
<h2>ç›®éŒ„</h2>
<p>éš¨ä¾¿é»å…¥ä¸‹æ–¹ä¸€å€‹ä¸»é¡Œä¾¿èƒ½å¿«é€Ÿè·³åˆ°è©²ä¸»é¡Œçš„èªªæ˜å€</p>
<ol>
  <li><a href="#section1">é–‹ç™¼æ¡†æ¶èˆ‡æŠ€è¡“æ£§ (Development Stack)</a></li>
  <li><a href="#section2">è©³ç´°è³‡æ–™åº«è¨­è¨ˆçµæ§‹ (Supabase PostgreSQL)</a></li>
  <li><a href="#section3">å‰å°åŠŸèƒ½ (Frontend Features)</a></li>
  <li><a href="#section4">å¾Œå°ç®¡ç†åŠŸèƒ½ (Backend Admin Features)</a></li>
  <li><a href="#section5">å¸³è™Ÿèˆ‡æ¬Šé™æ¶æ§‹ï¼ˆRole-Based Access Control, RBACï¼‰</a></li>
  <li><a href="#section6">JWT èº«åˆ†é©—è­‰æµç¨‹ï¼ˆå¾Œç«¯é©—è­‰æ–¹å¼ï¼‰</a></li>
  <li><a href="#section7">ç®¡ç†å“¡å¸³è™Ÿçš„å»ºç«‹æ–¹å¼</a></li>
  <li><a href="#section8">Figma è¨­è¨ˆï¼šè¨»å†Šèˆ‡ç™»å…¥é ï¼ˆWireframeï¼‰</a></li>
  <li><a href="#section9">Spring Bootï¼šè¨»å†Šèˆ‡ç™»å…¥ API ç¨‹å¼ç¢¼</a></li>
  <li><a href="#section10">Vue å‰ç«¯ï¼šç™»å…¥å¾Œä¾è§’è‰²å°å‘</a></li>
  <li><a href="#section11">Spring Securityï¼šå¾Œå° API æ¬Šé™é©—è­‰</a></li>
  <li><a href="#section12">æœ¬å°ˆæ¡ˆçš„æ¬Šé™å®‰å…¨çµè«–</a></li>
</ol>
<h2 id="section1">ä¸€ã€ é–‹ç™¼æ¡†æ¶èˆ‡æŠ€è¡“æ£§ (Development Stack)</h2>
<p>æŠ€è¡“æ£§é¸ç”¨è¢«å®šä½ç‚ºã€Œå–®äººé–‹ç™¼æœ€å¼·çµ„åˆã€ã€‚</p>

<table>
  <thead>
  <tr>
    <th>æŠ€è¡“çµ„æˆ</th>
    <th>æ ¸å¿ƒå„ªå‹¢èˆ‡åŠŸèƒ½</th>
    <th>æ¶æ§‹å®šä½èˆ‡è³‡æ–™æµ</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td><strong>å‰ç«¯ (Vue 3 + Vite)</strong></td>
    <td>çµ„ä»¶åŒ–ã€é–‹ç™¼å¿«é€Ÿ ã€‚ä½¿ç”¨ Pinia é€²è¡Œç‹€æ…‹ç®¡ç†ã€‚</td>
    <td>ç€è¦½å™¨ (RWD) ç«¯ï¼Œé€é Axios ç™¼é€è«‹æ±‚ã€‚é è¨ˆéƒ¨ç½²è‡³ GitHub Pagesã€‚</td>
  </tr>
  <tr>
    <td><strong>å¾Œç«¯ (Spring Boot 3)</strong></td>
    <td>ä¼æ¥­ç´šå¾Œç«¯ã€å…§å»º Security + JPAã€‚</td>
    <td>è™•ç† REST Controllersï¼›åŒ…å« JWT Filter é€²è¡Œå®‰å…¨é©—è­‰ã€‚è³‡æ–™ç¶“ Spring Data JPA å­˜å–è³‡æ–™åº«ã€‚é è¨ˆéƒ¨ç½²è‡³ GitHub Pagesã€‚</td>
  </tr>
  <tr>
    <td><strong>è³‡æ–™åº«/æœå‹™ (Supabase PostgreSQL)</strong></td>
    <td>å…ä¼ºæœå™¨ PostgreSQLï¼Œå…è²» 500MB è¶³å¤ å°ˆæ¡ˆä½¿ç”¨ã€‚å…§å»º Auth èº«ä»½é©—è­‰ã€‚</td>
    <td>æä¾›åº•å±¤è³‡æ–™å„²å­˜ï¼›è™•ç†ç”¨æˆ¶ç™»å…¥(ä½¿ç”¨è€… â†’ ç™»å…¥ â†’ Supabase Auth â†’ JWT)ã€‚</td>
  </tr>
  </tbody>
</table>

<hr>
<h2 id="section2">äºŒã€ è©³ç´°è³‡æ–™åº«è¨­è¨ˆçµæ§‹ (Supabase PostgreSQL)</h2>
<p>æ‰€æœ‰è¡¨æ ¼çš„è³‡æ–™å‹æ…‹ç‚ºå»ºè­°å€¼ï¼Œä»¥ç¢ºä¿åŠŸèƒ½å®Œæ•´æ€§ã€‚</p>

<table>
  <thead>
  <tr>
    <th>è¡¨æ ¼åç¨± (Table Name)</th>
    <th>æ¬„ä½åç¨± (Column)</th>
    <th>è³‡æ–™å‹åˆ¥ (Data Type)</th>
    <th>å‚™è¨» (Description)</th>
  </tr>
  </thead>
  <tbody>

  <!-- USERS -->
  <tr>
    <td rowspan="7"><strong>users</strong> (æœƒå“¡)</td>
    <td>user_id</td>
    <td>SERIAL (PK)</td>
    <td>ä¸»éµï¼Œè‡ªå‹•éå¢ã€‚</td>
  </tr>
  <tr>
    <td>username</td>
    <td>VARCHAR(50)</td>
    <td>æœƒå“¡å¸³è™Ÿ/æš±ç¨±ï¼ŒUNIQUEã€‚</td>
  </tr>
  <tr>
    <td>email</td>
    <td>VARCHAR(100)</td>
    <td>æœƒå“¡ä¿¡ç®±ï¼ŒUNIQUEã€‚</td>
  </tr>
  <tr>
    <td>password_hash</td>
    <td>TEXT</td>
    <td>Spring Security åŠ å¯†å¾Œçš„å¯†ç¢¼ (Bcrypt)ã€‚</td>
  </tr>
  <tr>
    <td>role</td>
    <td>VARCHAR(20)</td>
    <td>è§’è‰²ï¼šMEMBER æˆ– ADMINã€‚</td>
  </tr>
  <tr>
    <td>created_at</td>
    <td>TIMESTAMP WITH TIME ZONE</td>
    <td>è¨»å†Šæ™‚é–“ã€‚</td>
  </tr>
  <tr>
    <td>is_active</td>
    <td>BOOLEAN</td>
    <td>æœƒå“¡æ˜¯å¦å•Ÿç”¨ï¼åœç”¨å¸³è™Ÿã€‚</td>
  </tr>

  <!-- CATEGORIES -->
  <tr>
    <td rowspan="3"><strong>categories</strong> (æ›¸ç±é¡å‹)</td>
    <td>category_id</td>
    <td>SERIAL (PK)</td>
    <td>ä¸»éµï¼Œè‡ªå‹•éå¢ã€‚</td>
  </tr>
  <tr>
    <td>name_zh</td>
    <td>VARCHAR(50)</td>
    <td>åˆ†é¡åç¨± (ä¸­æ–‡ï¼Œä¾‹å¦‚ï¼šæ–‡æ³•ã€å–®å­—ã€æœƒè©±)ï¼ŒUNIQUEã€‚</td>
  </tr>
  <tr>
    <td>slug</td>
    <td>VARCHAR(50)</td>
    <td>ç¶²å€ç”¨æ¨™ç±¤ (å¦‚ grammar, vocab, reading)ã€‚</td>
  </tr>

  <!-- BOOKS -->
  <tr>
    <td rowspan="12"><strong>books</strong> (æ›¸ç±è³‡è¨Š)</td>
    <td>book_id</td>
    <td>SERIAL (PK)</td>
    <td>ä¸»éµï¼Œè‡ªå‹•éå¢ã€‚</td>
  </tr>
  <tr>
    <td>title</td>
    <td>VARCHAR(255)</td>
    <td>æ›¸ç±åç¨±ã€‚</td>
  </tr>
  <tr>
    <td>author</td>
    <td>VARCHAR(100)</td>
    <td>ä½œè€…ã€‚</td>
  </tr>
  <tr>
    <td>isbn</td>
    <td>VARCHAR(20)</td>
    <td>åœ‹éš›æ¨™æº–æ›¸è™Ÿï¼ŒUNIQUEã€‚</td>
  </tr>
  <tr>
    <td>price</td>
    <td>NUMERIC(10, 2)</td>
    <td>åƒ¹æ ¼ã€‚</td>
  </tr>
  <tr>
    <td>stock</td>
    <td>INTEGER</td>
    <td>åº«å­˜é‡ã€‚</td>
  </tr>
  <tr>
    <td>description</td>
    <td>TEXT</td>
    <td>æ›¸ç±ç°¡ä»‹ã€‚</td>
  </tr>
  <tr>
    <td>category_id</td>
    <td>INTEGER (FK)</td>
    <td>å¤–éµï¼Œé€£çµ categories.category_idã€‚</td>
  </tr>
  <tr>
    <td>lang</td>
    <td>VARCHAR(20)</td>
    <td>å­¸ç¿’èªè¨€åˆ†é¡ï¼Œä¾‹å¦‚ï¼šenglish, japanese, frenchã€‚</td>
  </tr>
  <tr>
    <td>image_url</td>
    <td>TEXT</td>
    <td>å°é¢åœ–ç‰‡ç¶²å€ (Supabase Storage)ã€‚</td>
  </tr>
  <tr>
    <td>is_onsale</td>
    <td>BOOLEAN</td>
    <td>ä¸Šæ¶(TRUE) / ä¸‹æ¶(FALSE)ã€‚</td>
  </tr>
  <tr>
    <td>published_date</td>
    <td>DATE</td>
    <td>å‡ºç‰ˆæ—¥æœŸã€‚</td>
  </tr>

  </tbody>
</table>
<hr>
<h2 id="section3">ä¸‰ã€ å‰å°åŠŸèƒ½ (Frontend Features)</h2>

<table>
  <thead>
  <tr>
    <th>åŠŸèƒ½æ¨¡çµ„</th>
    <th>åŠŸèƒ½ç´°é …</th>
    <th>å¯¦ä½œç´°ç¯€èˆ‡ä¾†æºä¾æ“š</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td><strong>æœƒå“¡åŠŸèƒ½</strong></td>
    <td>è¨»å†Šã€ç™»å…¥ã€ä¿®æ”¹ã€åˆªé™¤</td>
    <td>ç™»å…¥é€é Supabase Auth è™•ç†ï¼ŒJWT æ”¾ç½®åœ¨ Header ä¸­ä¾› Spring Boot é©—è­‰ã€‚</td>
  </tr>
  <tr>
    <td rowspan="2"><strong>æ›¸ç±æŸ¥è©¢</strong></td>
    <td>ä¾é—œéµå­—æŸ¥è©¢</td>
    <td>é€é Figma åŸå‹ä¸­ä¸Šæ–¹çš„æœå°‹æ¬„ä½å¯¦ç¾ã€‚</td>
  </tr>
  <tr>
    <td><span class="highlight">æŒ‰ç…§æ›¸æœ¬åˆ†é¡æŸ¥è©¢</span></td>
    <td>åˆ©ç”¨å‹•æ…‹å…§å®¹åˆ‡æ›æŠ€è¡“ï¼Œé€éèªè¨€æŒ‰éˆ• (English, æ—¥æœ¬èª, FranÃ§ais, Deutsch, EspaÃ±ol ç­‰) ç¯©é¸ã€‚ä¾è³´ <code>books</code> è¡¨çš„ <code>lang</code> æ¬„ä½ã€‚</td>
  </tr>
  <tr>
    <td rowspan="2"><strong>è³¼ç‰©èˆ‡çµå¸³</strong></td>
    <td>è³¼ç‰©è»Š</td>
    <td>ä½¿ç”¨ <code>cart_items</code> è¡¨æ ¼ï¼›Figma åŸå‹å±•ç¤ºäº†å•†å“æ¸…å–®èˆ‡å°è¨ˆã€‚</td>
  </tr>
  <tr>
    <td>çµå¸³æµç¨‹</td>
    <td>åˆ†ç‚º 1. è³‡è¨Š (å§“åã€åœ°å€)ã€2. é‹é€ã€3. è¨‚å–® ä¸‰æ­¥é©Ÿã€‚ä»˜æ¬¾æ–¹å¼æ”¯æ´ä¿¡ç”¨å¡æˆ–è²¨åˆ°ä»˜æ¬¾ã€‚</td>
  </tr>
  </tbody>
</table>

<hr>

<h2 id="section4">å››ã€ å¾Œå°ç®¡ç†åŠŸèƒ½ (Backend Admin Features)</h2>
<p>å¾Œå°ä»‹é¢è¨­è¨ˆå·²åŒ…å«ã€Œæ›¸æœ¬ã€ã€ã€Œè¨‚å–®ã€ã€ã€Œæœƒå“¡ã€å°èˆªæ¨¡çµ„ï¼Œæ‰€æœ‰æ“ä½œéœ€ç¶“ Spring Security + JWT Filter é©—è­‰ã€‚</p>

<table>
  <thead>
  <tr>
    <th>æ¨¡çµ„</th>
    <th>åŠŸèƒ½åç¨±</th>
    <th>å…·é«”æè¿° (ä¾æ“šä¾†æºèˆ‡è¦åŠƒ)</th>
    <th>ä¾†æºä¾æ“š</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td rowspan="4"><strong>æ›¸ç±ç®¡ç†</strong></td>
    <td>æ›¸ç±åˆ—è¡¨ç€è¦½èˆ‡ç‹€æ…‹ç›£æ§</td>
    <td>é¡¯ç¤ºæ›¸åã€åƒ¹æ ¼ã€ä»¥åŠæ›¸ç±çš„**ç‹€æ…‹** (ä¾‹å¦‚ï¼šã€Œå·²ä¸Šæ¶ã€)ã€‚</td>
    <td>Figma åŸå‹ã€Œå¾Œå°æ›¸æœ¬ç®¡ç†ã€</td>
  </tr>
  <tr>
    <td>æ–°å¢æ›¸ç± (Create)</td>
    <td>æä¾›è¡¨å–®ï¼Œå…è¨±ç®¡ç†å“¡å¡«å…¥æ›¸åã€åƒ¹æ ¼ã€èªè¨€ã€æè¿°ç­‰è³‡æ–™ã€‚</td>
    <td>Figma åŸå‹ã€Œæ–°å¢æ›¸æœ¬ã€</td>
  </tr>
  <tr>
    <td>ä¿®æ”¹æ›¸ç±è³‡è¨Š (Update)</td>
    <td>å…è¨±ç®¡ç†å“¡ç·¨è¼¯ç¾æœ‰æ›¸ç±çš„è©³ç´°è³‡æ–™ã€‚</td>
    <td>Figma åŸå‹ã€Œå¾Œå°æ›¸æœ¬ç®¡ç†ã€</td>
  </tr>
  <tr>
    <td><span class="highlight">**ä¸Šæ¶èˆ‡ä¸‹æ¶æ§åˆ¶**</span></td>
    <td>é€éä¿®æ”¹æ›¸ç±çš„ <span class="highlight"><code>status</code></span> æ¬„ä½ä¾†æ§åˆ¶å•†å“åœ¨å‰å°çš„é¡¯ç¤ºèˆ‡å¦ [FigmaåŸå‹å±•ç¤ºã€Œç‹€æ…‹ã€]ã€‚</td>
    <td>å°ˆæ¡ˆæ ¸å¿ƒéœ€æ±‚ (ç®¡ç†æ›¸ç±å«ä¸Šæ¶ä¸‹æ¶) [user query]</td>
  </tr>
  <tr>
    <td rowspan="2"><strong>è¨‚å–®ç®¡ç†</strong></td>
    <td>è¨‚å–®æ¸…å–®ç€è¦½</td>
    <td>æª¢è¦–æ‰€æœ‰é¡§å®¢çš„æ­·å²è¨‚å–®ç´€éŒ„ï¼Œè¿½è¹¤è¨‚å–®ç‹€æ…‹ã€‚</td>
    <td>Figma åŸå‹å´é‚Šå°èˆªã€Œè¨‚å–®ã€</td>
  </tr>
  <tr>
    <td>è¨‚å–®ç‹€æ…‹æ›´æ–°</td>
    <td>ç®¡ç†å“¡æ‰‹å‹•æ›´æ–°è¨‚å–®è™•ç†é€²åº¦ (ä¾‹å¦‚ï¼šå·²å‡ºè²¨)ï¼Œæ”¯æŒé›»å•†ç®¡ç†æµç¨‹ã€‚</td>
    <td>Figma åŸå‹å´é‚Šå°èˆªã€Œè¨‚å–®ã€</td>
  </tr>
  <tr>
    <td rowspan="2"><strong>æœƒå“¡ç®¡ç†</strong></td>
    <td>æœƒå“¡æ¸…å–®ç€è¦½</td>
    <td>æª¢è¦–æ‰€æœ‰ç”± Supabase Auth è¨»å†Šçš„æœƒå“¡åŸºæœ¬è³‡æ–™ã€‚</td>
    <td>Figma åŸå‹å´é‚Šå°èˆªã€Œæœƒå“¡ã€</td>
  </tr>
  <tr>
    <td>æœƒå“¡è³‡è¨ŠæŸ¥è©¢</td>
    <td>å…è¨±ç®¡ç†å“¡é‡å°ç‰¹å®šç”¨æˆ¶é€²è¡ŒæŸ¥è©¢ã€‚</td>
    <td>æœƒå“¡ç®¡ç†é‚è¼¯éœ€æ±‚</td>
  </tr>
  </tbody>
</table>
<hr>

<h2 id="section5">äº”ã€ å¸³è™Ÿèˆ‡æ¬Šé™æ¶æ§‹ï¼ˆRole-Based Access Control, RBACï¼‰</h2>

<p>
  æœ¬å°ˆæ¡ˆæ¡ç”¨ <strong>RBAC è§’è‰²æ¬Šé™æ¨¡å‹</strong>ï¼Œå°‡ä½¿ç”¨è€…å€åˆ†ç‚ºå…©é¡ï¼š
</p>

<table>
  <thead>
  <tr>
    <th>è§’è‰² (Role)</th>
    <th>ä¾†æº</th>
    <th>èƒ½åšçš„äº‹</th>
    <th>ä¸èƒ½åšçš„äº‹</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td><strong>MEMBER</strong>ï¼ˆä¸€èˆ¬æœƒå“¡ï¼‰</td>
    <td>ä½¿ç”¨ã€Œæœƒå“¡è¨»å†Šã€é é¢è¨»å†Š</td>
    <td>
      <ul>
        <li>è¨»å†Š / ç™»å…¥</li>
        <li>æœå°‹æ›¸ç±</li>
        <li>åŠ å…¥è³¼ç‰©è»Š / çµå¸³</li>
        <li>æ›´æ–°å€‹äººè³‡æ–™</li>
      </ul>
    </td>
    <td>
      <ul>
        <li>ä¸èƒ½é€²å…¥å¾Œå°</li>
        <li>ä¸èƒ½æ–°å¢ / ä¿®æ”¹ / åˆªé™¤æ›¸ç±</li>
        <li>ä¸èƒ½æŸ¥çœ‹è¨‚å–®ç¸½è¦½æˆ–ç®¡ç†æœƒå“¡</li>
      </ul>
    </td>
  </tr>
  <tr>
    <td><strong>ADMIN</strong>ï¼ˆç®¡ç†å“¡ï¼‰</td>
    <td>
      <strong>ä¸å¾å‰å°è¨»å†Šç²å¾—</strong><br>
      ç”±é–‹ç™¼è€…ä»¥ä»¥ä¸‹æ–¹å¼å»ºç«‹ï¼š
      <ul>
        <li>è³‡æ–™åº« SQL æ‰‹å‹•å»ºç«‹</li>
        <li>Spring Boot å°ˆæ¡ˆå•Ÿå‹•æ™‚è‡ªå‹•å»ºç«‹</li>
        <li>Supabase Dashboard æ–°å¢å¾Œå†æ”¹ role</li>
      </ul>
    </td>
    <td>
      <ul>
        <li>ç™»å…¥å¾Œé€²å…¥å¾Œå°ç®¡ç†ç³»çµ±</li>
        <li>æ–°å¢ / ä¿®æ”¹ / ä¸‹æ¶æ›¸ç±</li>
        <li>æŸ¥çœ‹èˆ‡æ›´æ–°è¨‚å–®</li>
        <li>æŸ¥çœ‹æœƒå“¡æ¸…å–®</li>
      </ul>
    </td>
    <td>ä¸èƒ½é€éå‰å°è¨»å†Šï¼ˆå®‰å…¨æ€§ï¼‰</td>
  </tr>
  </tbody>
</table>

<p>
  ğŸ“Œ <strong>é‡é»ï¼š</strong>ç®¡ç†å“¡éœ€é€éç™»å…¥æµç¨‹å–å¾— JWTï¼Œä½†ä¸èƒ½é€éè¨»å†Šæµç¨‹å–å¾—ã€ŒADMINã€ã€‚
</p>

<hr>

<h2 id="section6">å…­ã€ JWT èº«åˆ†é©—è­‰æµç¨‹ï¼ˆå¾Œç«¯é©—è­‰æ–¹å¼ï¼‰</h2>

<p>æœ¬å°ˆæ¡ˆä»¥ <strong>Spring Boot 3 + JWT</strong> ä½œç‚ºç™»å…¥èˆ‡æ¬Šé™æ§åˆ¶æ ¸å¿ƒæ©Ÿåˆ¶ã€‚</p>

<h3>ğŸ” JWT æµç¨‹åœ–ï¼ˆç²¾ç°¡ç‰ˆï¼‰</h3>

<table>
  <tbody>
  <tr>
    <td>
      <strong>1. ä½¿ç”¨è€…ç™»å…¥</strong><br>
      ä½¿ç”¨ email + å¯†ç¢¼ â†’ é€åˆ°å¾Œç«¯
    </td>
    <td>â¡</td>
    <td>
      <strong>2. å¾Œç«¯æ¯”å°å¯†ç¢¼</strong><br>
      é©—è­‰ Bcrypt æ˜¯å¦æ­£ç¢º
    </td>
    <td>â¡</td>
    <td>
      <strong>3. å¾Œç«¯ç”¢ç”Ÿ JWT</strong><br>
      Token å…§åŒ…å«è§’è‰²è³‡è¨Šï¼š<br>
      <code>{"sub": email, "role": "ADMIN"}</code>
    </td>
  </tr>
  <tr>
    <td colspan="5" style="text-align:center;">â¬‡ ä½¿ç”¨è€…æ”œå¸¶ JWT æ›åœ¨ Authorization Header</td>
  </tr>
  <tr>
    <td>
      <strong>4. å‰ç«¯å‘¼å« API</strong><br>
      Header: <code>Authorization: Bearer xxx</code>
    </td>
    <td>â¡</td>
    <td>
      <strong>5. JWT Filter é©—è­‰ Token</strong>
    </td>
    <td>â¡</td>
    <td>
      <strong>6. Spring Security æª¢æŸ¥è§’è‰²</strong><br>
      <ul>
        <li>ADMIN â†’ å¯ä»¥é€²å¾Œå° API</li>
        <li>MEMBER â†’ åªèƒ½é€²å‰å° API</li>
      </ul>
    </td>
  </tr>
  </tbody>
</table>

<p>
  âœ” é€™å¥—æµç¨‹èƒ½ç¢ºä¿ï¼š<br>
  <strong>ä¸€èˆ¬æœƒå“¡ç„¡æ³•å½é€ æˆç®¡ç†å“¡ â†’ å®‰å…¨å¯é ã€‚</strong>
</p>

<hr>

<h2 id="section7">ä¸ƒã€ ç®¡ç†å“¡å¸³è™Ÿçš„å»ºç«‹æ–¹å¼</h2>

<h3>æ–¹æ³• Aï¼šç›´æ¥åœ¨ PostgreSQL æ‰‹å‹•å»ºç«‹ï¼ˆæ¨è–¦ï¼‰</h3>

<pre>
INSERT INTO users (username, email, password_hash, role, is_active)
VALUES ('admin', 'admin@test.com',
        '$2a$10$XXXXXX',  -- bcrypt åŠ å¯†å¾Œå¯†ç¢¼
        'ADMIN', TRUE);
</pre>

<h3>æ–¹æ³• Bï¼šSpring Boot å°ˆæ¡ˆå•Ÿå‹•æ™‚è‡ªå‹•å»ºç«‹</h3>

<pre>
@Bean
CommandLineRunner initAdmin(UserRepository repo, PasswordEncoder encoder) {
    return args -> {
        if (!repo.existsByEmail("admin@test.com")) {
            User admin = new User();
            admin.setUsername("admin");
            admin.setEmail("admin@test.com");
            admin.setPasswordHash(encoder.encode("admin123"));
            admin.setRole("ADMIN");
            repo.save(admin);
        }
    };
}
</pre>

<h3>æ–¹æ³• Cï¼šSupabase Dashboard æ‰‹å‹•æ–°å¢</h3>

<ol>
  <li>Supabase â†’ Authentication â†’ Add User</li>
  <li>æ–°å¢ email / å¯†ç¢¼</li>
  <li>é€²å…¥ SQL Editor åŸ·è¡Œï¼š
    <pre>
UPDATE users SET role='ADMIN'
WHERE email='admin@test.com';
  </pre></li>
</ol>

<p>âœ” ä»»ä½•æ–¹æ³•éƒ½æ¯”è®“ç®¡ç†å“¡é€éå‰å°è¨»å†Šå®‰å…¨å¾—å¤šã€‚</p>

<hr>
<hr>


<h2 id="section8">å…«ã€Figma AI åŸå‹èˆ‡è³‡æ–™åŒæ­¥èªªæ˜</h2>

<p>
  å‰ç«¯ç•«é¢éƒ¨åˆ†é€é <strong>Figma AI</strong> ç”Ÿæˆé«˜æ“¬çœŸç¶²é ç•«é¢ï¼ŒåŒ…æ‹¬æœƒå“¡ç™»å…¥/è¨»å†Šã€æ›¸ç±ç€è¦½ã€è³¼ç‰©è»Šèˆ‡çµå¸³ç­‰åŠŸèƒ½ã€‚
</p>

<p><strong>æ³¨æ„äº‹é …ï¼š</strong></p>
<ul>
  <li>Figma åŸå‹ä¸­çš„è³‡æ–™ç‚º <strong>æ­»è³‡æ–™ / æ¨¡æ“¬è³‡æ–™</strong>ï¼Œä¸æœƒå¯¦éš›å­˜å…¥è³‡æ–™åº«ã€‚</li>
  <li>ä½ åœ¨éŒ„å½±æˆ– Figma åŸå‹ä¸­æ“ä½œçš„ã€ŒåŠ å…¥è³¼ç‰©è»Šã€æˆ–ã€Œé€å‡ºè¨‚å–®ã€æ•ˆæœï¼Œåƒ…æ˜¯è¦–è¦ºäº’å‹•æ¨¡æ“¬ï¼Œä¸¦ä¸æœƒå½±éŸ¿å¾Œå°è³‡æ–™ã€‚</li>
  <li>å¾Œå°ç®¡ç†ä»‹é¢é¡¯ç¤ºçš„æ˜¯ <strong>çœŸå¯¦è³‡æ–™åº«</strong> (Supabase PostgreSQL) çš„å…§å®¹ï¼Œå› æ­¤ä½ ä¸æœƒåœ¨å¾Œå°çœ‹åˆ°åŸå‹ä¸­æ–°å¢çš„å‡è³‡æ–™ã€‚</li>
  <li>å‰ç«¯çœŸå¯¦åŠŸèƒ½éœ€è¦ç¨‹å¼ç¢¼ä¸²æ¥å¾Œç«¯ API æ‰èƒ½è®“è³‡æ–™åŒæ­¥åˆ°å¾Œå°ï¼Œä¾‹å¦‚ï¼š
    <ul>
      <li>æœƒå“¡æ“ä½œ â†’ å‘¼å« /api/login æˆ– /api/register</li>
      <li>è³¼ç‰©è»Š / è¨‚å–® â†’ å‘¼å« /api/cartã€/api/order</li>
    </ul>
  </li>
  <li>åœ¨å°ˆæ¡ˆå±•ç¤ºæˆ–å ±å‘Šä¸­ï¼Œå¯å°‡ Figma éŒ„å½±ä½œç‚ºã€ŒåŠŸèƒ½æ¼”ç¤ºã€ä½¿ç”¨ï¼Œä½†éœ€è¨»æ˜è³‡æ–™ç‚ºæ¨¡æ“¬ï¼Œé¿å…æ··æ·†ã€‚</li>
</ul>

<p>
  ç¸½çµï¼šFigma AI åŸå‹æä¾›äº†é«˜æ“¬çœŸè¦–è¦ºæ•ˆæœèˆ‡æ“ä½œæµç¨‹ï¼Œä½†è³‡æ–™ä¸æœƒè‡ªå‹•å¯«å…¥å¾Œç«¯ã€‚çœŸå¯¦è³‡æ–™åŒæ­¥ä»éœ€å‰ç«¯ç¨‹å¼èˆ‡å¾Œç«¯ API é…åˆã€‚
</p>

<hr>


<h2 id="section9">ä¹ã€ Spring Bootï¼šè¨»å†Šèˆ‡ç™»å…¥ API ç¨‹å¼ç¢¼</h2>

<p>ç‚ºäº†å®‰å…¨ï¼Œå¾Œç«¯å¼·åˆ¶æ‰€æœ‰è¨»å†Šè€Œä¾†çš„å¸³è™Ÿçš†ç‚º MEMBERã€‚</p>

<h3>1. è¨»å†Š APIï¼ˆRegisterï¼‰</h3>

<pre>
@PostMapping("/register")
public ResponseEntity<?> register(@RequestBody RegisterRequest req) {

    if (userRepo.existsByEmail(req.getEmail())) {
        return ResponseEntity.badRequest().body("Email å·²å­˜åœ¨");
    }

    User user = new User();
    user.setUsername(req.getUsername());
    user.setEmail(req.getEmail());
    user.setPasswordHash(encoder.encode(req.getPassword()));

    // å¼·åˆ¶æ‰€æœ‰å‰å°è¨»å†Šè€…è§’è‰²ç‚º MEMBER
    user.setRole("MEMBER");

    userRepo.save(user);

    return ResponseEntity.ok("è¨»å†ŠæˆåŠŸ");
}
</pre>

<h3>2. ç™»å…¥ APIï¼ˆLoginï¼‰</h3>

<pre>
@PostMapping("/login")
public ResponseEntity<?> login(@RequestBody LoginRequest req) {

    User user = userRepo.findByEmail(req.getEmail())
            .orElseThrow(() -> new RuntimeException("å¸³è™Ÿä¸å­˜åœ¨"));

    if (!encoder.matches(req.getPassword(), user.getPasswordHash())) {
        return ResponseEntity.badRequest().body("å¯†ç¢¼éŒ¯èª¤");
    }

    String token = jwtService.generateToken(user);

    return ResponseEntity.ok(new LoginResponse(token, user.getRole()));
}
</pre>

<h3>3. JWT å…§å®¹ç¤ºä¾‹</h3>

<pre>
{
  "sub": "admin@test.com",
  "role": "ADMIN",
  "exp": 1712345678
}
</pre>

<p>âœ” JWT å…§åŒ…å«ä½¿ç”¨è€…è§’è‰²ï¼Œå¯ç”¨æ–¼å‰ç«¯åˆ¤æ–·å°å‘é é¢ã€‚</p>

<hr>

<h2 id="section10">åã€ Vue å‰ç«¯ï¼šç™»å…¥å¾Œä¾è§’è‰²å°å‘</h2>

<p>å‰ç«¯æœƒæ¥æ”¶ login API å›å‚³çš„ roleã€‚</p>

<h3>ç™»å…¥æ–¹æ³•ï¼š</h3>

<pre>
axios.post('/login', { email, password })
  .then(res => {
    const token = res.data.token;
    const role = res.data.role;

    localStorage.setItem('token', token);
    localStorage.setItem('role', role);

    if (role === "ADMIN") {
        router.push('/admin');
    } else {
        router.push('/');
    }
  });
</pre>

<h3>å‰ç«¯è·¯ç”±ä¿è­·ï¼ˆmiddlewareï¼‰</h3>

<pre>
router.beforeEach((to, from, next) => {
  const role = localStorage.getItem('role');
  const token = localStorage.getItem('token');

  if (to.meta.requiresAdmin) {
    if (token && role === "ADMIN") next();
    else next('/login');
  } else {
    next();
  }
});
</pre>

<p>âœ” èƒ½ç¢ºä¿ä¸€èˆ¬æœƒå“¡ç„¡æ³•ç›´æ¥é€²å…¥å¾Œå° URLã€‚</p>

<hr>

<h2 id="section11">åä¸€ã€ Spring Securityï¼šå¾Œå° API æ¬Šé™é©—è­‰</h2>

<p>å¾Œå° API ä¾‹å¦‚ï¼š</p>

<ul>
  <li>æ–°å¢æ›¸ç±ï¼šPOST /admin/books</li>
  <li>ä¿®æ”¹æ›¸ç±ï¼šPUT /admin/books/{id}</li>
  <li>æŸ¥çœ‹å…¨éƒ¨è¨‚å–®ï¼šGET /admin/orders</li>
</ul>

<h3>Security é…ç½®ï¼š</h3>

<pre>
http
  .authorizeHttpRequests(auth -> auth
      .requestMatchers("/admin/**").hasRole("ADMIN")
      .requestMatchers("/user/**").hasAnyRole("MEMBER", "ADMIN")
      .requestMatchers("/public/**", "/login", "/register").permitAll()
      .anyRequest().authenticated()
  )
  .addFilterBefore(jwtFilter, UsernamePasswordAuthenticationFilter.class);
</pre>

<p>
  âœ” åªè¦ JWT ä¸­è§’è‰²ä¸æ˜¯ ADMINï¼Œå°±ç„¡æ³•é€²å…¥ <code>/admin/**</code> APIã€‚
  âœ” é€™æ˜¯å¾Œç«¯æœ€é‡è¦çš„å®‰å…¨ä¿éšœã€‚
</p>

<hr>

<h2 id="section12">åäºŒã€ æœ¬å°ˆæ¡ˆçš„æ¬Šé™å®‰å…¨çµè«–</h2>

<ul>
  <li><strong>ç®¡ç†å“¡ä¸å¯ç”¨æœƒå“¡è¨»å†Šæ–¹å¼ç”¢ç”Ÿ â†’ å¿…é ˆäººå·¥å»ºç«‹</strong></li>
  <li>ç™»å…¥å¾Œä¾è§’è‰²ç”¢ç”Ÿä¸åŒæ¬Šé™</li>
  <li>å‰ç«¯ä¾æ“š role å°å‘ä¸åŒä»‹é¢</li>
  <li>å¾Œç«¯ä»¥ JWT + Spring Security ä½œå¼·åˆ¶é©—è­‰</li>
</ul>

<p>
  ğŸ”’ <strong>ç¢ºä¿ç¶²ç«™å‰å°èˆ‡å¾Œå°å®Œå…¨åˆ†é›¢ã€å®‰å…¨ã€å¯é ã€‚</strong>
</p>

</body>
</html>